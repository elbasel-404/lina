// public/sw.js
self.addEventListener("install", (event) => {
  // Skip the waiting phase so new service worker activates immediately
  self.skipWaiting();
});

self.addEventListener("activate", (event) => {
  // Take control of uncontrolled clients immediately
  event.waitUntil(self.clients.claim());
});

self.addEventListener("fetch", (event) => {
  const { request } = event;
  try {
    const url = new URL(request.url);
    // const a = request.json();
    // Intercept requests to /api/post
    if (url.pathname === "/api/post") {
      // The worker can handle or modify the response. Here we'll return a JSON response
      // which emulates handling client-side.
      const data = {
        // a,
        intercepted: true,
        pathname: url.pathname,
        method: request.method,
        message: "This response was generated by the service worker.",
      };
      const response = new Response(JSON.stringify(data), {
        status: 200,
        headers: { "Content-Type": "application/json" },
      });
      event.respondWith(response);
      return;
    }
  } catch (err) {
    // Non-http(s) scheme or other issues â€” just fall through
    console.warn("SW: fetch handler error", err);
  }

  // Default: let the network handle the request
  // (do nothing; fetch proceeds normally)
});
